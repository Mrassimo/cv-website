#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

# Check for .env files being committed
if git diff --cached --name-only | grep -qE '\.env'; then
  echo "❌ Error: .env files should not be committed!"
  echo "Please unstage .env files before committing."
  exit 1
fi

# Check for potential API keys in staged files
if git diff --cached | grep -iE '(api[_-]?key|secret[_-]?key|api[_-]?secret|GEMINI_API_KEY|OPENAI_API_KEY)["\s]*[:=]["\s]*[A-Za-z0-9+/=_-]{20,}'; then
  echo "❌ Error: Potential API key detected in staged changes!"
  echo "Please remove sensitive data before committing."
  exit 1
fi

echo "✅ Pre-commit checks passed"
